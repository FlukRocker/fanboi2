{% from "partials/form.jinja2" import form_field, form_submit %}
{% from "partials/post.jinja2" import post_block %}
{% extends "topics/layout.jinja2" %}

{% block content %}
<div class="topic-show">
  <div class="posts">
    {% for post in posts %}
      {{ post_block(post) }}
    {% endfor %}
    <div class="quicklinks">
      <div class="container">
        <ul class="unstyled">
          <li><a href="{{ request.resource_path(topic) }}" class="btn"><i class="icon-th-list"></i> All posts</a></li>
          <li><a href="{{ request.resource_path(topic, "recent") }}" class="btn"><i class="icon-inbox"></i> Recent posts</a></li>
          <li><a href="{{ request.resource_path(topic, "%s-" % topic.obj.post_count) }}" class="btn"><i class="icon-forward"></i> New since visit</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div id="reply" class="post-new">
    {% if topic.obj.status == "open" %}
      <header class="container">
        <h3>Reply</h3>
      </header>
      <form action="{{ request.resource_path(topic) }}" method="POST" class="form">
        <div class="container">
          <div class="well">
            {{ form_field(form.body) }}
            {{ form_submit("Post Reply") }}
          </div>
        </div>
      </form>
    {% elif topic.obj.status == "archived" %}
      <header class="container">
        <h3>Post limit exceeded</h3>
        <p>Please start a new topic.</p>
      </header>
    {% elif topic.obj.status == "locked" %}
      <header class="container">
        <h3>Topic locked</h3>
        <p>Topic has been locked by moderator.</p>
      </header>
    {% endif %}
  </div>
</div>
{% endblock %}
